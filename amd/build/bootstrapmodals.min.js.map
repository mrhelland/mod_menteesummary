{"version":3,"file":"bootstrapmodals.min.js","sources":["../src/bootstrapmodals.js"],"sourcesContent":["/**\n * Display feedback modals near click position and narrower on desktop.\n *\n * @module mod_menteesummary/bootstrapmodals\n */\ndefine(['jquery', 'core/modal', 'core/modal_events', 'core/notification'],\nfunction($, Modal, ModalEvents, Notification) {\n\n    let lastClick = {x: window.innerWidth / 2, y: window.innerHeight / 2};\n\n    const init = () => {\n\n        // Track last click position globally (anywhere on document)\n        $(document).on('click', function(e) {\n            lastClick = {x: e.clientX, y: e.clientY};\n        });\n\n        // Handle feedback button clicks\n        $(document).on('click', '[data-feedback-target]', function(e) {\n            e.preventDefault();\n\n            const target = $(this).attr('data-feedback-target');\n            const title  = $(this).data('title') || 'Feedback';\n            const $content = $(target);\n\n            if (!$content.length) {\n                return;\n            }\n\n            const bodyHtml = `\n                <div class=\"modal-scrollable p-3\" style=\"max-height:60vh; overflow-y:auto;\">\n                    ${$content.html() || ''}\n                </div>\n            `;\n\n            Modal.create({\n                title: title,\n                body: bodyHtml,\n                large: true\n            }).then(modal => {\n                  const $root = modal.getRoot();\n                  const $dialog = $root.find('.modal-dialog');\n                  $root.removeClass('modal-dialog-centered');\n                  // ✳️ Make narrower on desktop\n                  $dialog.css({\n                      'max-width': '450px',\n                      'margin': '0',\n                      'position': 'fixed'\n                  });\n\n                  // ✳️ Position near click (stay within viewport)\n                  const modalWidth  = 450;\n                  const modalHeight = 300;\n\n                  const left = Math.min(\n                      Math.max(lastClick.x - modalWidth / 2, 20),\n                      window.innerWidth - modalWidth - 20\n                  );\n                  const top = Math.min(\n                      Math.max(lastClick.y - modalHeight / 3, 20),\n                      window.innerHeight - modalHeight - 20\n                  );\n\n                  $dialog.css({\n                      left: `${left}px`,\n                      top: `${top}px`\n                  });\n\n                  $dialog.css({ opacity: 0, transform: 'scale(0.9)' });\n                      setTimeout(() => {\n                          $dialog.css({\n                              transition: 'opacity 0.2s ease, transform 0.2s ease',\n                              opacity: 1,\n                              transform: 'scale(1)'\n                          });\n                      }, 10);\n\n\n                  // ✅ Keep Moodle backdrop fully functional\n                  modal.show();\n                  modal.getRoot().on('shown.bs.modal', () => {\n                      $('.modal-backdrop').last().css('opacity', '0.1');\n                  });\n                  modal.getRoot().on(ModalEvents.hidden, () => modal.destroy());\n              }).catch(err => {\n                Notification.exception(err);\n            });\n        });\n    };\n\n    return { init: init };\n});\n\n\n\n\n\n\n\n\n"],"names":["define","$","Modal","ModalEvents","Notification","lastClick","x","window","innerWidth","y","innerHeight","init","document","on","e","clientX","clientY","preventDefault","target","this","attr","title","data","$content","length","bodyHtml","html","create","body","large","then","modal","$root","getRoot","$dialog","find","removeClass","css","left","Math","min","max","modalWidth","top","modalHeight","opacity","transform","setTimeout","transition","show","last","hidden","destroy","catch","err","exception"],"mappings":"AAKAA,2CAAO,CAAC,SAAU,aAAc,oBAAqB,sBACrD,SAASC,EAAGC,MAAOC,YAAaC,kBAExBC,UAAY,CAACC,EAAGC,OAAOC,WAAa,EAAGC,EAAGF,OAAOG,YAAc,SAkF5D,CAAEC,KAhFI,KAGTV,EAAEW,UAAUC,GAAG,SAAS,SAASC,GAC7BT,UAAY,CAACC,EAAGQ,EAAEC,QAASN,EAAGK,EAAEE,YAIpCf,EAAEW,UAAUC,GAAG,QAAS,0BAA0B,SAASC,GACvDA,EAAEG,uBAEIC,OAASjB,EAAEkB,MAAMC,KAAK,wBACtBC,MAASpB,EAAEkB,MAAMG,KAAK,UAAY,WAClCC,SAAWtB,EAAEiB,YAEdK,SAASC,oBAIRC,uIAEIF,SAASG,QAAU,6CAI7BxB,MAAMyB,OAAO,CACTN,MAAOA,MACPO,KAAMH,SACNI,OAAO,IACRC,MAAKC,cACIC,MAAQD,MAAME,UACdC,QAAUF,MAAMG,KAAK,iBAC3BH,MAAMI,YAAY,yBAElBF,QAAQG,IAAI,aACK,eACH,aACE,gBAOVC,KAAOC,KAAKC,IACdD,KAAKE,IAAIpC,UAAUC,EAAIoC,IAAgB,IACvCnC,OAAOC,WALS,IAKiB,IAE/BmC,IAAMJ,KAAKC,IACbD,KAAKE,IAAIpC,UAAUI,EAAImC,IAAiB,IACxCrC,OAAOG,YARS,IAQmB,IAGvCwB,QAAQG,IAAI,CACRC,eAASA,WACTK,cAAQA,YAGZT,QAAQG,IAAI,CAAEQ,QAAS,EAAGC,UAAW,eACjCC,YAAW,KACPb,QAAQG,IAAI,CACRW,WAAY,yCACZH,QAAS,EACTC,UAAW,eAEhB,IAIPf,MAAMkB,OACNlB,MAAME,UAAUpB,GAAG,kBAAkB,KACjCZ,EAAE,mBAAmBiD,OAAOb,IAAI,UAAW,UAE/CN,MAAME,UAAUpB,GAAGV,YAAYgD,QAAQ,IAAMpB,MAAMqB,eACpDC,OAAMC,MACPlD,aAAamD,UAAUD"}
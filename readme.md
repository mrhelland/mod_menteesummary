# 🧩 Moodle Activity Module: Mentee Summary

## Overview

**Mentee Summary** is a custom Moodle activity module (`mod_menteesummary`) that allows mentors (e.g. parents, professional observers) to view academic progress for their assigned mentees across multiple courses.  
It aggregates **assignments, quizzes, grades, and feedback** for each mentee in one place, providing a clear summary of current performance and progress.


## ⚠️ Known Limitations

Due to issues retreiving accurate final grades, this module no longer relies on built-in Moodle methods to get the final grade. It iterates through the visible assignments and calculates the final grade using category weights in this manner:

- Category weights are retrieved from the gradebook setup
- If any categories have no active assignments, the weights are proportionally scaled to sum to 100%
- All assignments in a category iterated for earned and possible points
  - Currently, missing and ungraded assignments are evaluated to 0 out of the possible
  - This is easily added as a setting since the library helper function exposes flags for these
- Category grades are calculated by dividing earned points by total points
- Category grades are weighted and added together for the total grade

I plan to rework this to be fully Moodle-compliant. However, I went through quite a few iterations without success and finally decided to just make it work for my situation.


## ✨ Key Features

- Displays all mentees linked to the current user.  
- Provides detailed grade and progress summaries per course.  
- Shows assignments, quizzes, due dates, grades, and feedback in a unified view.  
- Automatically selects a mentee or course when only one exists.  
- Enforces Moodle capability checks (`mod/menteesummary:view` and `mod/menteesummary:viewall`).  
- Uses Moodle context and rendering APIs (`$PAGE`, `$OUTPUT`, Mustache templates).  
- Securely enforces mentor–mentee relationships via custom validation functions.


## 🧱 Architecture

| **Component** | **Purpose** |
|----------------|-------------|
| **`view.php`** | Main controller that handles data gathering, security checks, and Mustache rendering. |
| **`locallib.php`** | Contains data helper functions (e.g., `menteesummary_get_user_mentees`, `menteesummary_get_all_assignments`, `menteesummary_calculate_overall_grade`). |
| **`templates/view.mustache`** | Displays selected mentee details, course tabs, and activity summaries. |
| **`templates/chooser.mustache`** | Displays mentee selection screen when multiple mentees exist. |
| **`classes/output/chooser.php`** | Output class for rendering the mentee selection view. |
| **`lang/xx/menteesummary.php** | Translations generated by AI included for common languages |


## 🔒 Security Notes

- Enforces login and capability at both **module** and **course** contexts.  
- Prevents unauthorized users from viewing other mentee data.  
- Uses Moodle’s `context_module` and `context_course` for consistent access control.  
- Disables page caching per user (`$PAGE->set_cacheable(false)`).


## 📊 Data Sources

The module retrieves data from these Moodle tables and APIs:

- **Course & Context:** `course`, `course_modules`, `context`  
- **Assignments:** `assign`, `assign_submission`, `assign_grades`  
- **Quizzes:** `quiz`, `quiz_attempts`, `quiz_grades`  
- **Grades:** `grade_items`, `grade_grades`, `gradebook API`  
- **Users:** `user`, `user_picture`  


## 🧩 Dependencies

- **Moodle core:** 4.5 or later
- **Requires:**  
  - `gradelib.php` for grade calculations  
  - `user/lib.php` for user data  
  - `theme_boost_union` (was only tested using this theme)
- **Mustache Templates:** Required for UI rendering  
- **JavaScript AMD modules:**  
  - `theme_boost_union/bootstrap`  
  - `mod_menteesummary/bootstrapmodals`


## 🧪 Example Workflow

1. Mentor accesses the Mentee Summary activity.  
2. The module lists all mentees connected to the mentor.  
3. Mentor selects a mentee → module loads all mentee courses.  
4. Mentor views assignments, quizzes, grades, and feedback per course.  
5. Grades are color-coded by performance and grouped by category.


## 🕊️ Privacy

This module **does not store or transmit personal data**.  
It only reads existing Moodle user, course, and grade data to display mentee summaries.

Privacy declaration:

```php
$string['privacy:metadata'] = 'The Mentee Summary activity does not store any personal data.';
```


